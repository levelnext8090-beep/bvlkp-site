<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BVLKP Membership - Official Registration</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&display=swap');
        body { font-family: 'Poppins', sans-serif; background-color: #f1f5f9; }
        .form-section { border-left: 4px solid #1e3a8a; padding-left: 15px; margin-bottom: 25px; }
    </style>
</head>
<body>

    <a href="index.html" class="fixed top-5 left-5 z-[100] bg-blue-900 text-white w-12 h-12 rounded-full flex items-center justify-center shadow-2xl hover:bg-orange-500 transition-all border-2 border-white" title="मुख्य पृष्ठ पर जाएं">
        <i class="fas fa-home text-lg"></i>
    </a>

    <div class="min-h-screen p-4 md:p-10">
        <div class="max-w-4xl mx-auto bg-white rounded-3xl shadow-2xl overflow-hidden border border-gray-200">
            
            <div class="bg-blue-900 p-8 text-white text-center">
                <h1 class="text-2xl md:text-3xl font-black mb-2">सदस्यता एवं "अनलिमिटेड फॉर्म" सेवा</h1>
                <p class="text-orange-400 font-bold uppercase tracking-widest text-sm">भारतीय विद्यार्थी लोक कल्याण परिषद</p>
                <p class="text-[10px] opacity-70 mt-1">(MCA & NITI Aayog Registered Organization)</p>
            </div>

            <form id="membershipForm" class="p-6 md:p-10 space-y-8">
                
                <div class="form-section">
                    <h3 class="text-blue-900 font-bold uppercase text-sm mb-4"><i class="fas fa-user-circle mr-2"></i> 1. व्यक्तिगत विवरण (Personal Details)</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                        <input type="text" id="name" placeholder="पूरा नाम" required class="p-3 border rounded-xl w-full">
                        <input type="text" id="parent_name" placeholder="पिता/पति का नाम" required class="p-3 border rounded-xl w-full">
                        <div class="flex gap-2">
                            <input type="date" id="dob" required class="p-3 border rounded-xl w-full text-gray-500">
                            <select id="gender" class="p-3 border rounded-xl w-full text-gray-500">
                                <option>पुरुष</option>
                                <option>महिला</option>
                                <option>अन्य</option>
                            </select>
                        </div>
                        <input type="text" id="aadhar" placeholder="आधार नंबर" required class="p-3 border rounded-xl w-full">
                        <input type="tel" id="mobile" placeholder="WhatsApp नंबर" required class="p-3 border rounded-xl w-full">
                        <input type="email" id="email" placeholder="ईमेल आईडी" required class="p-3 border rounded-xl w-full">
                    </div>
                </div>

                <div class="form-section">
                    <h3 class="text-blue-900 font-bold uppercase text-sm mb-4"><i class="fas fa-graduation-cap mr-2"></i> 2. शैक्षिक विवरण (Educational Details)</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                        <input type="text" id="edu" placeholder="उच्चतम योग्यता (Ex: BA, BSc, 12th)" required class="p-3 border rounded-xl w-full">
                        <select id="occupation" class="p-3 border rounded-xl w-full text-gray-500">
                            <option>छात्र</option>
                            <option>बेरोजगार</option>
                            <option>स्वरोजगार</option>
                            <option>अन्य</option>
                        </select>
                    </div>
                </div>

                <div class="form-section">
                    <h3 class="text-blue-900 font-bold uppercase text-sm mb-4"><i class="fas fa-map-marker-alt mr-2"></i> 3. पते का विवरण (Address Details)</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                        <input type="text" id="address" placeholder="पूरा पता (हाउस नंबर, गली आदि)" required class="p-3 border rounded-xl w-full md:col-span-2">
                        <input type="text" id="district" placeholder="जिला" required class="p-3 border rounded-xl w-full">
                        <input type="text" id="state" placeholder="राज्य" required class="p-3 border rounded-xl w-full">
                    </div>
                </div>

                <button type="button" id="submitBtn" onclick="handlePayment()" class="w-full bg-blue-900 text-white font-black py-5 rounded-2xl text-lg hover:bg-blue-800 transition shadow-2xl flex justify-center items-center gap-4">
                    <span>भुगतान करें और पंजीकरण पूर्ण करें (₹200)</span>
                    <i class="fas fa-arrow-right"></i>
                </button>
            </form>
        </div>
    </div>

    <script>
        // अपना नया Deployment URL यहाँ डालें (Deploy -> New Deployment वाला)
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxkpnTQjrJR9OWlAZ39WZB2dAQ5zzWCJ5csN_cFw83pt83AfIClEkCkjwWupsl5wx_E-Q/exec'; 

        function handlePayment() {
            // फॉर्म वैलिडेशन
            const requiredFields = ['name', 'parent_name', 'dob', 'aadhar', 'mobile', 'email', 'edu', 'address', 'district', 'state'];
            for(let fieldId of requiredFields) {
                if(!document.getElementById(fieldId).value) {
                    alert("कृपया सभी अनिवार्य विवरण भरें!");
                    document.getElementById(fieldId).focus();
                    return;
                }
            }

            // Razorpay ऑप्शंस
            var options = {
                "key": "rzp_live_SC4t1pIf0OYfFU", // आपकी लाइव की आईडी
                "amount": "20000", // ₹200.00 (पैसे में)
                "name": "BVLKP Membership",
                "description": "Unlimited Form Service Fee",
                "handler": function (response){
                    // पेमेंट सफल होने पर डेटा एक्सेल में भेजें
                    saveDataToExcel(response.razorpay_payment_id);
                },
                "prefill": {
                    "name": document.getElementById('name').value,
                    "contact": document.getElementById('mobile').value,
                    "email": document.getElementById('email').value
                },
                "theme": { "color": "#1e3a8a" }
            };
            var rzp = new Razorpay(options);
            rzp.open();
        }

        async function saveDataToExcel(razorPayTxnId) {
            const btn = document.getElementById('submitBtn');
            btn.innerHTML = "<i class='fas fa-spinner fa-spin'></i> भुगतान सफल! आईडी बन रही है...";
            btn.disabled = true;

            // फॉर्म डेटा इकट्ठा करना
            const formData = new URLSearchParams();
            formData.append('name', document.getElementById('name').value);
            formData.append('parent_name', document.getElementById('parent_name').value);
            formData.append('dob', document.getElementById('dob').value);
            formData.append('aadhar', document.getElementById('aadhar').value);
            formData.append('mobile', document.getElementById('mobile').value);
            formData.append('email', document.getElementById('email').value);
            formData.append('edu', document.getElementById('edu').value);
            formData.append('occupation', document.getElementById('occupation').value);
            formData.append('address', document.getElementById('address').value);
            formData.append('district', document.getElementById('district').value);
            formData.append('state', document.getElementById('state').value);
            formData.append('payment_id', razorPayTxnId); // असली Razorpay ID भेज रहे हैं

            try {
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    body: formData,
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' }
                });

                const result = await response.json();

                if (result.result === "success") {
                    alert("धन्यवाद! आपका पंजीकरण सफल रहा।\nआपकी संस्था आईडी: " + result.payment_id);
                    // कार्ड देखने के लिए डायरेक्ट भेजें
                    window.location.href = "verify.html?regId=" + result.payment_id; 
                } else {
                    alert("सर्वर में कुछ समस्या आई, लेकिन आपका पेमेंट सफल रहा है। कृपया अपनी रसीद सुरक्षित रखें।");
                }
            } catch (error) {
                console.error('Error:', error);
                alert("नेटवर्क एरर! कृपया अपना कार्ड मोबाइल नंबर से चेक करें।");
                window.location.href = "verify.html";
            }
        }
    </script>
</body>
</html>